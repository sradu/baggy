(function() { function bxBootstrap() {
	if (!(window.bouncex&&bouncex.website)) {
		var pushedData = [];
		if(window.bouncex && bouncex.push && bouncex.length){
			pushedData = bouncex;
		}
		window.bouncex = {};
		bouncex.pushedData = pushedData;
		bouncex.website = {"id":1595,"cookie_name":"bounceClientVisit1595","domain":"ray-ban.comusa","ct":"bind_to_domain","ally":0,"ei":0,"tcjs":"","cjs":"/** https://www.wrike.com/open.htm?id=364255809 **/\nbouncex.report_ga = function(action, label, bypass) {\n    try {\n        if (typeof window.ClickTaleIsRecording == 'function' && window.ClickTaleIsRecording() && typeof window.ClickTaleEvent == 'function') {\n            ClickTaleEvent(action + ' - ' + label.split('-').pop().trim());\n        }\n    } catch(e) {}\n};\n\nwindow.top.bouncex.tealiumTracker = function(campaignName, parentName, eventType) {\n\tvar tealium_data2track = window.top.tealium_data2track || [];\n\tvar speakingString = 'X-X-X-BounceX-'+ eventType;\n\ttealium_data2track.push({\n\t\t'id': speakingString,\n\t\t'Content_TestCampaign': parentName,\n\t\t'Content_TestVariation': campaignName\n\t});\n};\n\n/* https://www.wrike.com/open.htm?id=439784749 */\nwindow.top.bouncex.tealiumTrackerV2 = function(ca_id, eventType) {\n    var campaign = bouncex.campaigns[ca_id];\n\tvar campaignLabel = campaign.ga_i.label.toLowerCase();\n\tvar childString = '';\n\tvar parentString = '';\n\n\tif (campaignLabel.indexOf('email capture') > -1 || campaignLabel.indexOf('capture email') > -1) {\n\t    parentString += 'emailCapture ';\n\t} else if (campaignLabel.indexOf('cart') > -1) {\n\t    parentString += 'cartRecovery ';\n\t} else if (campaignLabel.indexOf('checkout') > -1) {\n\t    parentString += 'checkoutShaping ';\n\t} else {\n\t    parentString += 'Campaign ';\n\t}\n\n\tparentString += campaignLabel.indexOf('mobile') > -1 ? 'M ' : 'D ';\n\tparentString += '('+campaign.pid+')';\n\n\tchildString += campaign.ttype === 'variation' ? 'variation ' : 'control ';\n\tchildString += '('+ca_id+')';\n\t\n\tvar tealium_data2track = window.top.tealium_data2track || [];\n\tvar speakingString = 'Bounce-'+ eventType;\n\t\n\ttealium_data2track.push({\n\t\t'id': speakingString,\n\t\t'Tool_Name_Abbreviation': 'BO',\n\t\t'Content_TestCampaign': parentString,\n\t\t'Content_TestVariation': childString\n\t});\n};\n\njQuery('body').on('click.bx-cart_total', '#M_PDP_Prod_BuyNow, #addCartButton', function() {\n    var new_total = Number(bouncex.vars.cart_total) + (Number(jQuery('.previewPrice').text().replace(/[^0-9\\\\.]/g,'')) || Number(jQuery('#priceField').text().replace(/[^0-9\\\\.]/g,'')));\n    bouncex.setv('cart_total', new_total);\n    bouncex.setBounceCookie();\n});\n\n\n\n/*\n    Dev: David Andersen\n    Added: 4-11-2018\n    Wrike: https://www.wrike.com/open.htm?id=227612125\n    Purpose:\n        Add sessionStore for email storing and population.\n*/\n\nbouncex.sessionStore = (function() {\n\tvar sessionStorageIdentifier = 'bxSessionStore';\n\n\tfunction getSessionStore() {\n\t\tvar encodedStore = sessionStorage.getItem(sessionStorageIdentifier);\n\t\tvar decodedStore = bouncex.lz.decompressFromURI(encodedStore);\n\n\t\treturn decodedStore ? JSON.parse(decodedStore) : {};\n\t}\n\n\tfunction set(entryObj) {\n\t\tvar currentStore = getSessionStore();\n\t\tvar updatedStore = Object.assign(currentStore, entryObj);\n\t\tvar encodedStore = bouncex.lz.compressToURI(JSON.stringify(updatedStore));\n\n\t\ttry {\n\t\t\tsessionStorage.setItem(sessionStorageIdentifier, encodedStore);\n\t\t}\n\t\tcatch (e) {\n\t\t\tbouncex.err(e);\n\t\t}\n\t}\n\n\tfunction get(entryInput) {\n\t\tvar currentStore = getSessionStore();\n\t\tvar outputObject;\n\n\t\tif (typeof entryInput === 'string') {\n\t\t\treturn entryInput in currentStore ? currentStore[entryInput] : '';\n\t\t}\n\t\telse if (Array.isArray(entryInput)) {\n\t\t\toutputObject = {};\n\n\t\t\tentryInput.forEach(function(entryName) {\n\t\t\t\toutputObject[entryName] = entryName in currentStore ? currentStore[entryName] : '';\n\t\t\t});\n\n\t\t\treturn outputObject;\n\t\t}\n\t\telse {\n\t\t\treturn currentStore;\n\t\t}\n\t}\n\n\tfunction entryExists(entryName) {\n\t\treturn !!get(entryName);\n\t}\n\n\tfunction populateFields(fieldMap) {\n\t\tvar currentStore = getSessionStore();\n\n\t\tfor (var field in fieldMap) {\n\t\t\tjQuery(fieldMap[field]).val(currentStore[field]);\n\t\t}\n\t}\n\n\treturn {\n\t\tset: set,\n\t\tget: get,\n\t\tentryExists: entryExists,\n\t\tpopulateFields: populateFields\n\t};\n})();\n\n\n\n\n// if ( bouncex.vars.ibx_test ) {\n  // console.log('inside');\n//KK ISR tracking, boilerplate altered to include separate mobile tracking\n(function () {\n\twindow.bouncex = window.bouncex || {};\n\n\twindow.bouncex.bxISR = {\n\t\t/* --- INITIALIZATION --- */\n\t\tversion: 'Version 8.1 | 1/4/17',\n\t\tstartTime: Date.now(),\n\t\tsettings: {\n\t\t\tcurrentProduct: {},\n\t\t\tgeneral: {\n\t\t\t\tproductPageIdentifier: window.location.href.indexOf('customize') === -1 && jQuery('meta[property=\"og:type\"]').length > 0 && jQuery('meta[property=\"og:type\"]').attr('content') === 'product',\n\t\t\t\tmobilePageIdentifier: window.location.href.indexOf('/mobile') > -1 && window.location.href.indexOf('customize') === -1 && window.location.href.indexOf('virtual-try-on') === -1 && (jQuery('#pdp').length > 0 || jQuery('#producttype').length > 0 && jQuery('#producttype').val() !== 'Home'),\n\t\t\t\tmaxProducts: 20,\n\t\t\t\tcategoryHistory: JSON.parse(window.localStorage.getItem('bxCatHist')) || [],\n\t\t\t\tproductHistory: JSON.parse(window.localStorage.getItem('bxProdHist')) || [],\n\t\t\t\tcategoryHistoryLength: 0,\n\t\t\t\tproductHistoryLength: 0\n\t\t\t}\n\t\t},\n\n\t\tinit: function () {\n\t\t\tthis.productMap();\n\t\t\tthis.setItemHistoryLengths();\n\t\t\tthis.trackProductHistory();\n\t\t\tthis.trackCategoryHistory();\n\t\t\tthis.maxProducts();\n\t\t// \tconsole.log(Date.now() - window.bouncex.bxISR.startTime, 'bxISR start');\n\t\t},\n\n\t\tproductMap: function () {\n\t\t\tvar productValues;\n\t\t\tif ( this.settings.general.mobilePageIdentifier) {\n\t\t\t\tvar imgUrl = jQuery('#main-image-container .wcs-main-image:visible').length > 0? jQuery('#main-image-container .wcs-main-image:visible').attr('src').split('?')[0].replace(/fr$/, 'qt') : '',\n\t\t\t\t\tcategory = window.location.href.match(/mobile\\/(.+?)\\//);\n\t\t\t\tproductValues = {\n\t\t\t\t\turl: jQuery('link[rel=canonical]').attr('href'),\n\t\t\t\t\tname: jQuery('#productName').val().toUpperCase(),\n\t\t\t\t\tsku: jQuery('#parentPartNumber').val() || window.location.href.split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\tcategory: [{ categoryName: category, categoryUrl: 'http://www.ray-ban.com/usa/mobile/' + category + '/clp'}],\n\t\t\t\t\tdescription: jQuery('#wcs-product-details-overlay .wcs-half-top').text().trim(),\n\t\t\t\t\tprice: jQuery('.previewPrice').text().replace(/[^0-9.]/g, ''),\n\t\t\t\t\tmainImgUrl: imgUrl.indexOf('http') > -1 ? imgUrl : 'http:' + imgUrl,\n\t\t\t\t\ttimeStamp: Date.now(),\n\t\t\t\t\tviewCount: 1,\n\t\t\t\t\tsessionId: window.bouncex.cookie.vid\n\t\t\t\t};\n\t\t\t} else if (this.settings.general.productPageIdentifier){\n\t\t\t  \n\t\t\tvar imgUrlProd = jQuery('#main-image-container .wcs-main-image:visible').length > 0? jQuery('#main-image-container .wcs-main-image:visible').attr('src').split('?')[0].replace(/fr$/, 'qt') : '';\n\t\t\t\tvar $category = jQuery('.breadCrumbLabel:eq(-1)');\n\t\t\t\tproductValues = {\n\t\t\t\t\turl: jQuery('link[rel=canonical]').attr('href'),\n\t\t\t\t\tname: jQuery('#productName').val().toUpperCase(),\n\t\t\t\t\tsku: jQuery('[itemprop=productID]').text() || window.location.href.split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\tcategory: [{ categoryName: $category.text().trim().toLowerCase(), categoryUrl: $category.parent().attr('href') }],\n\t\t\t\t\tdescription: jQuery('.more-block .wcs-half-top').text().trim(),\n\t\t\t\t\tprice: jQuery('#wcs-productprice').text().replace(/[^0-9.]/g, ''),\n\t\t\t\t\tmainImgUrl: imgUrlProd,\n\t\t\t\t\ttimeStamp: Date.now(),\n\t\t\t\t\tviewCount: 1,\n\t\t\t\t\tsessionId: window.bouncex.cookie.vid\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.settings.currentProduct = productValues;\n\t\t},\n\n\t\t/* --- END OF INITIALIZATION --- */\n\t\t/* --- HELPER FUNCTIONS --- */\n\n\t\taddProductToHistory: function (product) {\n\t\t\tvar productHistory = this.settings.general.productHistory;\n\t\t\tproductHistory.unshift(product);\n\t\t\tthis.setProductHistory(productHistory);\n\t\t},\n\n\t\taddCategoryToHistory: function (currentCategory) {\n\t\t\tvar categoryHistory = this.settings.general.categoryHistory;\n\t\t\tvar newCategory = {\n\t\t\t\tcategory: currentCategory,\n\t\t\t\tviewCount: 1,\n\t\t\t\ttimeStamp: Date.now()\n\t\t\t};\n\n\t\t\tcategoryHistory.unshift(newCategory);\n\t\t\twindow.bouncex.bxISR.setCategoryHistory(categoryHistory);\n\t\t},\n\n\t\tcompareProducts: function (productA, productB) {\n\t\t\tif (productA.mainImgUrl === productB.mainImgUrl) { return true; }\n\t\t\tif (productA.sku === productB.sku) { return true; }\n\t\t\tif (productA.name === productB.name) { return true; }\n\t\t\tif (productA.url === productB.url) { return true; }\n\t\t\treturn false;\n\t\t},\n\n\t\ttrackProductHistory: function () {\n\t\t\tvar productHistory = this.settings.general.productHistory;\n\t\t\tif (!this.settings.general.productPageIdentifier && !this.settings.general.mobilePageIdentifier) { return; }\n\n\t\t\tif (this.settings.general.productHistoryLength > 0) {\n\t\t\t\tvar historyUpdated = false;\n\n\t\t\t\tfor (var i = 0; i < this.settings.general.productHistoryLength; i++) {\n\t\t\t\t\tif (this.compareProducts(productHistory[i], this.settings.currentProduct)) {\n\t\t\t\t\t\tproductHistory[i].viewCount++;\n\t\t\t\t\t\tproductHistory[i].timeStamp = Date.now();\n\t\t\t\t\t\tproductHistory.unshift(productHistory[i]);\n\n\t\t\t\t\t\tproductHistory.splice(i + 1, 1);\n\t\t\t\t\t\thistoryUpdated = true;\n\t\t\t\t\t\tthis.setProductHistory(productHistory);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!historyUpdated) {\n\t\t\t\t\tthis.addProductToHistory(this.settings.currentProduct);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addProductToHistory(this.settings.currentProduct);\n\t\t\t}\n\t\t},\n\n\t\ttrackCategoryHistory: function () {\n\t\t\tvar categoryHistory = this.settings.general.categoryHistory;\n\t\t\tif (!this.settings.general.productPageIdentifier && !this.settings.general.mobilePageIdentifier) { return; }\n\n\t\t\tvar currentCategoriesLength = this.settings.currentProduct.category.length;\n\t\t\tfor (var i = 0; i < currentCategoriesLength; i++) {\n\t\t\t\tvar currentCategory = this.settings.currentProduct.category[i];\n\n\t\t\t\tif (this.settings.general.categoryHistoryLength > 0) {\n\t\t\t\t\tvar historyUpdated = false;\n\t\t\t\t\tfor (var j = 0; j < this.settings.general.categoryHistoryLength; j++) {\n\t\t\t\t\t\tif (categoryHistory[j].category.categoryName === currentCategory.categoryName) {\n\t\t\t\t\t\t\tcategoryHistory[j].viewCount++;\n\t\t\t\t\t\t\tcategoryHistory[j].timeStamp = Date.now();\n\t\t\t\t\t\t\thistoryUpdated = true;\n\t\t\t\t\t\t\tthis.setCategoryHistory(categoryHistory);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!historyUpdated) {\n\t\t\t\t\t\tthis.addCategoryToHistory(currentCategory);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.addCategoryToHistory(currentCategory);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/* --- END OF HELPER FUNCTIONS --- */\n\t\t/* --- GETTER FUNCTIONS --- */\n\n\t\tgetTopCategories: function (criteria, number) {\n\t\t\tvar categories = this.settings.general.categoryHistory;\n\t\t\tif (!number) { number = categories.length; }\n\n\t\t\tif (criteria === 'views') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number);\n\t\t\t} else if (criteria === 'time') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.timeStamp - a.timeStamp; }).slice(0, number);\n\t\t\t} else if (criteria === 'recency') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number).sort(function (c, d) { return d.timeStamp - c.timeStamp; });\n\t\t\t}\n\t\t},\n\n\t\tgetTopProducts: function (criteria, number) {\n\t\t\tvar products = this.settings.general.productHistory;\n\t\t\tif (!number) { number = products.length; }\n\t\t\tif (criteria === 'views') {\n\t\t\t\treturn products.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number);\n\t\t\t} else if (criteria === 'time') {\n\t\t\t\treturn products.sort(function (a, b) { return b.timeStamp - a.timeStamp; }).slice(0, number);\n\t\t\t} else if (criteria === 'recency') {\n\t\t\t\treturn products.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number).sort(function (c, d) { return d.timeStamp - c.timeStamp; });\n\t\t\t}\n\t\t},\n\n\t\tmaxProducts: function () {\n\t\t\tvar maxProducts = this.settings.general.maxProducts;\n\t\t\tif (this.settings.general.productHistoryLength > maxProducts) {\n\t\t\t\tvar topProducts = this.getTopProducts('time', maxProducts);\n\t\t\t\tthis.setProductHistory(topProducts);\n\t\t\t}\n\t\t},\n\n\t\t/* --- END GETTER FUNCTIONS --- */\n\t\t/* --- SETTER FUNCTIONS --- */\n\n\t\tsetItemHistoryLengths: function () {\n\t\t\tthis.settings.general.categoryHistoryLength = this.settings.general.categoryHistory.length;\n\t\t\tthis.settings.general.productHistoryLength = this.settings.general.productHistory.length;\n\t\t},\n\n\t\tsetProductHistory: function (productHistory) {\n\t\t\twindow.localStorage.setItem('bxProdHist', JSON.stringify(productHistory));\n\t\t\tthis.settings.general.productHistory = productHistory;\n\t\t\tthis.settings.general.productHistoryLength = productHistory.length;\n\t\t},\n\n\t\tsetCategoryHistory: function (categoryHistory) {\n\t\t\twindow.localStorage.setItem('bxCatHist', JSON.stringify(categoryHistory));\n\t\t\tthis.settings.general.categoryHistory = categoryHistory;\n\t\t\tthis.settings.general.categoryHistoryLength = categoryHistory.length;\n\t\t},\n\n\t\t/* --- END SETTER FUNCTIONS --- */\n\t\t/* --- CAMPAIGN TEMPLATING --- */\n\n\t\tpopulateCampaignProductsV2: function (params) {\n\t\t\tif (!params || !params.campaignId || !params.numberProducts) { return false; }\n\t\t\tif (!params.sortBy) { params.sortBy = 'time'; }\n\t\t\tif (!params.productAction) { params.productAction = 'link'; }\n\t\t\tif (!params.linkAction) { params.linkAction = 'new'; }\n\n\t\t\tvar campaign = jQuery('#bx-campaign-' + params.campaignId);\n\t\t\tvar campaignProductArray = [];\n\n\t\t\tcampaignProductElements = {};\n\t\t\tjQuery.each(params.campaignSteps, function (x, y) {\n\n\t\t\t\tcampaignStepProductElements = [];\n\t\t\t\tfor ( var i = 0; i < params.numberProducts; i++ ) {\n\t\t\t\t\tvar campaignStepProductObject = {};\n\t\t\t\t\tif (y.productImages) {\n\t\t\t\t\t\tcampaignStepProductObject.img = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-row-line-custom .bx-lineshape:eq(' + i +')');\n\t\t\t\t\t}\n\t\t\t\t\tif (y.productLinkElems) {\n\t\t\t\t\t\t// campaignStepProductObject.link = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group .bx-row-submit:eq('+i+')').find('button');\n\t\t\t\t\t\tcampaignStepProductObject.link = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group-custom:eq('+i+')');\n\t\t\t\t\t}\n\t\t\t\t\tif (y.productHoverStates) {\n\t\t\t\t\t\tcampaignStepProductObject.hoverTitle = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group .bx-row-line-custom:eq(' + i +')').siblings('.bx-row-text').find('div');\n\t\t\t\t\t}\n\t\t\t\t\tcampaignStepProductElements.push(campaignStepProductObject);\n\t\t\t\t}\n\n\t\t\t\tcampaignProductElements['step-' +x] = campaignStepProductElements;\n\t\t\t});\n\n\t\t\tvar productArray = window.bouncex.bxISR.getTopProducts(params.sortBy, params.numberProducts);\n\n\t\t\tvar self = this;\n\t\t\tjQuery.each(campaignProductElements, function (x, y) {\n\t\t\t\tvar productAction = function () {};\n\n\t\t\t\tfor ( var i = 0; i < y.length; i++ ) {\n\t\t\t\t\tif (params.campaignSteps[(x.split('-')[1])].productsLink) {\n\t\t\t\t\t\tvar productLink = (productArray[i].url.indexOf('http') > -1) ? productArray[i].url : window.top.location.origin + productArray[i].url;\n\t\t\t\t\t\tproductAction = self.makeProductAction(productLink, params);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].img) {\n\t\t\t\t\t\tvar imgSrc = productArray[i].mainImgUrl,\n\t\t\t\t\t\t\tproductImageElem = jQuery(y[i].img);\n\n\t\t\t\t\t\tproductImageElem.css('background-image', 'url(' + imgSrc + ')').addClass('isr-image isr' + x + '').bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].link) {\n\t\t\t\t\t\tvar productLink = (productArray[i].url.indexOf('http') > -1) ? productArray[i].url : window.top.location.origin + productArray[i].url,\n\t\t\t\t\t\t\tproductLinkElem = jQuery(y[i].link);\n\n\t\t\t\t\t\tproductLinkElem.attr('bx-href', productLink).bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].hoverTitle) {\n\t\t\t\t\t\tvar productTitle = productArray[i].name,\n\t\t\t\t\t\t\tproductHoverTitleElem = jQuery(y[i].hoverTitle);\n\n\t\t\t\t\t\tproductHoverTitleElem.text(productTitle).bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\tmakeProductAction: function (productLink, campaignParams) {\n\t\t\tvar productAction = function () {};\n\n\t\t\t\tif (campaignParams.productAction === 'link') {\n\t\t\t\t\tif (campaignParams.linkAction === 'new') {\n\t\t\t\t\t\tif (campaignParams.reportClicks) {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.bouncex.report(campaignParams.campaignId, 'click');\n\t\t\t\t\t\t\t\twindow.top.open(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.top.open(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (campaignParams.linkAction === 'current') {\n\t\t\t\t\t\tif (campaignParams.reportClicks) {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.bouncex.report(campaignParams.campaignId, 'click');\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\twindow.top.location.replace(productLink);\n\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.top.location.replace(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\treturn productAction;\n\t\t}\n\t};\n  setTimeout(function(){\n    \twindow.bouncex.bxISR.init();\n  },500);\n})();\n\n  \n// }","force_https":false,"waypoints":false,"content_width":0,"gai":"UA-15393223-2","swids":"","sd":0,"ljq":"auto","campaign_id":0,"is_preview":false,"aco":{"first_party_limit":"3500","local_storage":"1"},"cmp":{"gdpr":1,"gmp":0,"whitelist_check":0},"burls":[{"prop":"contains","val":"stab.ray-ban"},{"prop":"contains","val":"prop.ray-ban"},{"prop":"contains","val":"v7stage.ray-ban"},{"prop":"contains","val":"v7live.ray-ban"}],"ple":false,"fbe":false,"mas":2,"map":1,"gar":true,"ete":0,"ettm":true,"etjs":"","dge":true,"bxidLoadFirst":false,"gbi_enabled":0,"gbi":{"rblocks":null},"bpush":false,"pt":{"cart":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":" window.location.pathname ==='/ShopCartDisplayView';"}]]},"category":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"(function() {\n    var categories = ['/clv', '/plp', '/clp', '/virtual-model', '/lenses'];\n    var pathname = window.location.pathname;\n    for (var i = 0; i < categories.length; i++) {\n        if (pathname.indexOf(categories[i]) > -1) {\n            return true;\n        }\n    }\n    return ['/usa/customize', '/uk/customise', '/uk/mobile/customise', '/usa/mobile/customize'].indexOf(window.location.pathname) > -1;\n})();"}]]},"checkout":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"jQuery('.checkout-header-hr, #checkout').length > 0;"}]]},"home":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"['/usa','/uk','/uk/mobile','/usa/mobile'].indexOf(window.location.pathname) > -1;"}]]},"product":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"document.querySelector('meta[property=\"og:type\"]').content === 'product' || document.querySelectorAll('#wcs-pdp-buy-button-display, #cartMobile').length > 0;"}]]},"search":{"testmode":true,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"window.location.pathname === '/SearchDisplay';"}]]}},"els":null,"vars":[{"name":"logged_in","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function(){\n\tif(jQuery('#logout').length > 0 || jQuery('.wcs-myacc-logout').length >  0){\n\t\treturn true;\n\t}\n\n\tif(jQuery('#loginespot').length > 0 || jQuery('.wcs-myacc-loginlink').length > 0){\n\t\treturn false;\n\t}\n\n\treturn null;\n})();","trigger":""},{"name":"ever_logged_in","polling":"all","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"bouncex.vars.logged_in || null;","trigger":""},{"name":"items_in_cart","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"0","code":"(function() {\n    var $cart = jQuery('#wcs-cart-container');\n    if ($cart.length > 0) {\n        if (typeof $cart.find('#tcount').val() == \"undefined\") return null;\n        var numItems = parseInt($cart.find('#tcount').val());\n        if (!isNaN(numItems)) {\n            return numItems;\n        } else {\n            return 0;\n        }\n    }\n    var $mobileCheckoutCart = jQuery('#cart-qty');\n    if ($mobileCheckoutCart.length > 0){\n        return +$mobileCheckoutCart.find('span').text()\n    }\n    var $mobileCart = jQuery('.rb-icon-shoppingbag-bright');\n    if ($mobileCart.length > 0){\n        return +$mobileCart.attr('data-counter');\n    }\n    return null;\n})();","trigger":""},{"name":"submitted_onsite","polling":"all","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"jQuery('#wcs-newsletter-footer-signup-response').find('.signupThankYou:visible:contains(\"Thank you for signing up\")').length > 0 || null","trigger":""},{"name":"cart_total","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"0","code":"(function() {\n    var $subtotalDiv = jQuery('#wcs-cart-container');\n    var $mobileTotal = jQuery('#total-cart #total');\n    if ($subtotalDiv.length > 0) {\n        var total = $subtotalDiv.find('.wcs-subtotal:contains(\"Subtotal\")').find('span').eq(1).text().trim().replace('$','');\n        if (total && !isNaN(total)) {\n            return total;\n        } else {\n            return 0;\n        }\n    } else if ($mobileTotal.length > 0) {\n      return Number(jQuery('#total-cart #total').text());\n    } else {\n        return null;\n    }\n})();","trigger":""},{"name":"product_page","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('meta[property=\"og:type\"]').attr('content') == 'product' || jQuery('#pdp').length > 0 || jQuery('#productName').length > 0","trigger":""},{"name":"remix_page","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n    if (typeof window.utag_data !== 'undefined') {\n        if (utag_data.Page_Name === \"Remix:Configurator\" || utag_data.Page_NameFull.indexOf('RB_US:Remix:') > -1){\n            return true;\n        }\n    }\n})();","trigger":""},{"name":"cart_count_start","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"0","code":"/*cart count at beginning of pageview */\nbouncex.vars.items_in_cart;","trigger":""},{"name":"added_cart_pv","polling":"vars","persist":"no","page_types":[],"testmode":false,"default":"false","code":"/*returns true if user added to cart on this page view */\n!!bouncex.vars.items_in_cart && bouncex.vars.items_in_cart > bouncex.vars.cart_count_start;","trigger":""},{"name":"ibx_test","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"location.href.indexOf('ibx_test')>=0 || null;","trigger":""},{"name":"both_in_cart","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var numAllProdsInCart = jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod').length ? jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod').length : 0;\n    var numRemixProdsInCart = jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod').length ? jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod.remix-pd').length : 0;\n    \n    if (numRemixProdsInCart > 0 && numAllProdsInCart > numRemixProdsInCart) {\n        return true;\n    } else {\n        return false;\n    }\n})();","trigger":""},{"name":"multiple_remix_in_cart","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var numRemixProdsInCart = jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod').length ? jQuery('.wcs-shopping-cart').find('.wcs-minicart-prod.remix-pd').length : 0;\n    if (numRemixProdsInCart > 1) {\n        return true;\n    } else {\n        return false;\n    }\n})();","trigger":""},{"name":"page_name","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n\tif( typeof window.top.utag !== 'undefined' && typeof window.top.utag.data !== 'undefined' && typeof window.top.utag.data.Page_Name !== 'undefined' ){\n\t\treturn window.top.utag.data.Page_Name;\n\t}\n})();","trigger":""},{"name":"viewed_items","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"0","code":"(function() {\n    if (jQuery('#pdp_page').length > 0) {\n        return bouncex.vars.viewed_items + 1;\n    }\n    return null;\n})();","trigger":""},{"name":"viewed_remix_items","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"0","code":"(function() {\n    var $productType = jQuery('#producttype');\n    if ($productType.length > 0 && $productType.attr('value') === 'Remix') {\n        return bouncex.vars.viewed_remix_items + 1;\n    }\n    return null;\n})();","trigger":""},{"name":"category_page","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('#pageTemplate').val() === 'CategoryListing';","trigger":""},{"name":"products_tracked","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"0","code":"JSON.parse(localStorage.getItem('bxProdHist')).length;","trigger":""},{"name":"excluded_prod_upc","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function(){\n\tvar excludedUPCArray = [805289126577,805289602057,805289628460,805289742470,805289114567,805289653653,805289126591,8053672495744,805289653660,805289270102,8053672610451,805289048527,805289602071,805289115694,805289330462,805289346890,805289439899,805289288695,805289742463,805289628231];\n\n\tvar miniCartProductID = jQuery('.wcs-minicart-prod.last').children().find('img').attr('id');\n\tfor(var i = 0; i < miniCartProductID.length; i++){\n\t\tif(miniCartProductID.indexOf(excludedUPCArray[i]) > -1){\n\t\t\treturn true;\n\t\t}\n\t}\n})();","trigger":""},{"name":"cart","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":0,"code":"null","trigger":""},{"name":"in_stock","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var productPage = jQuery('meta[property=\"og:type\"]').attr('content') === 'product';\n    \n    if (productPage) {\n        return jQuery('.wcs-item-not-available:visible').length === 0;\n    }\n})()","trigger":""},{"name":"navbar_open","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('.wcs-drop_panel:visible').length > 0;","trigger":""},{"name":"side_minicart_open","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('.wcs-right-panel:visible').length > 0;","trigger":""},{"name":"vto_this_visit","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"bouncex.vars.vto_this_visit || (function() {\n    var $vto = jQuery('.vto-application');\n    if ($vto.find('.preview-account-page').length > 0 || $vto.find('.preview-page').length > 0) {\n      return true;\n    }\n    return null;\n})();","trigger":""},{"name":"virtual_model_saved","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"bouncex.utils.cookies.read('vtorenderstatus') !== null ? true : null;","trigger":""},{"name":"create_virtual_model_page","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"window.location.pathname.indexOf('/mobile/') > -1 ? jQuery('.vto-cta-button').is(':visible') : jQuery('#D_PDP_Prod_VtoTryThemOnLink').is(':visible');","trigger":""},{"name":"using_edge_browser","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"bouncex.browser.edge","trigger":""},{"name":"customizable_click_url","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var customizeText = jQuery('.customize-it-text');\n    var customizeTextMobile = jQuery('.wcs-customize_new_link-mobile > a');\n\n    if (customizeText.length > 0) {\n      return customizeText.attr('href');\n    } else if(customizeTextMobile.length > 0){\n      return customizeTextMobile.attr('href');\n    } \n})();","trigger":""},{"name":"product_name","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('meta[property=\"og:type\"]').attr('content') === 'product' || jQuery('#wcs-pdp-buy-button-display').length > 0 ? jQuery('#wcs-productdescval, .productHeader-col-left h1').eq(0).text() : null;","trigger":"pageload"},{"name":"remix_product_name","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"window.location.href.indexOf('/customize/') > -1 ? jQuery('#modelTitle').text().replace(/[^a-zA-Z0-9\\s]/g, '') : false;","trigger":"pageload"}],"dgu":"pixel.cdnwidget.com","dgp":false,"ba":{"enabled":0,"fbte":0},"biu":"assets.bounceexchange.com","bau":"api.bounceexchange.com","beu":"events.bouncex.net","ibx":{"tjs":"//RS most recent update 9/27/19\n\n// Track only US users\n\n// if (bouncex.campaigns[usUserCampaign] || bouncex.vars.ibx_test) {\n\n\n\tjQuery('input').not(':input[type=button], :input[type=submit], :input[type=reset], :input[type=hidden], :input[type=radio], :input[type=checkbox], :input[type=image], :input[type=password], :input[id*=wcs_userEmail], :input[id*=rb-input-Remail], :input[id*=rb-input-ConfirmEmail]').blur(function(){\n\t\tvar source = jQuery(this).attr(\"id\");\n\t\tbouncex.ibx.user( jQuery(this).val(), {__src: source } );\n\t});\n\t\n\t/* legacy cart replenishment -- leaving in temporarily to support recently sent v1 emails -SK */\n\tvar ibxCart = bouncex.ibx._getparam('ibx_cart');\n\tvar ibxReplenishType = bouncex.ibx._getparam('ibx_replenish_type');\n\tif (ibxCart.length > 0 && ibxReplenishType.length > 0) {\n\t\tvar ibxCartReg = decodeURIComponent(bouncex.ibx._getparam('reg', ibxCart));\n\t\tvar ibxCartRemix = decodeURIComponent(bouncex.ibx._getparam('remix', ibxCart));\n\t\n\t\tif (ibxReplenishType === 'reg' && ibxCartReg.length > 0) {\n\t\t\tsetTimeout(function(){\n\t\t\t\tvar emptyCart = window.location.href.indexOf('/mobile') !== -1 ? jQuery('input[name=orderitemquantityVar]:last').val() === '0' : !jQuery('#selenium-bag .wcs-product-count-circle').is(':visible');\n\t\t\t\tif (!emptyCart) { \n\t\t\t\t\twindow.location.href = '/ShopCartDisplayView';\n\t\t\t\t} else {\n\t\t\t\t\tvar items = ibxCartReg.substring(1).split('|');\n\t\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\t// \tconsole.log(items[i]);\n\t\t\t\t\t\tvar data = items[i].indexOf('URL') === -1? 'URL=ShopCartDisplayView&field1=0&storeId='+jQuery('#storeId').val()+'&calculateOrder=1&langId=-1&pageName=ProductPage&pgName=PDP&catEntryId=' + bouncex.ibx._getparam('catEntryId', items[i]) + '&quantity=' + bouncex.ibx._getparam('quantity', items[i]) : items[i];\n\t\n\t\t\t\t\t// \tconsole.log(data);\n\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\turl: 'http://www.ray-ban.com/usa/sunglasses/aviator/clv/AjaxOrderItemAdd?' + data,\n\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\tasync: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\twindow.location.href = '/ShopCartDisplayView';\n\t\t\t\t}\n\t\t\t},3000);\t\n\t\t}\n\t\tif (ibxReplenishType === 'remix' && ibxCartRemix.length > 0) {\n\t\t\twindow.location.href = ibxCartRemix.replace('orderItemId=','temp=');\n\t\t}\n\t}\n\t\n\t\n\t/************************************************************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t/**************************** V2 INBOX    *******************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t/************************************************************************/\n\t\n\t\n\t\n\t\tbouncex.util = {\n\t\n\t\t\taddNamespace: function(obj, name) {\n\t\t\t\tvar namespacedObj = {};\n\t\t\t\tfor (var k in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(k)) {\n\t\t\t\t\t\tvar namespacedKey = k;\n\t\t\t\t\t\tif (k.indexOf(':') === -1) {\n\t\t\t\t\t\t\tnamespacedKey = name + ':' + k;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnamespacedObj[namespacedKey] = obj[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn namespacedObj;\n\t\t\t},\n\t\n\t\t//copied from bouncex.ibx\n\t\tgetParam: function(name, qstring) {\n\t\t\tvar param_string = qstring ? ('?' + qstring) : window.location.href;\n\t\t\tname = name.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\n\t\t\tvar regexS = \"[\\\\?&#]\"+name+\"=([^&#]*)\";\n\t\t\tvar regex = new RegExp( regexS );\n\t\t\tvar results = regex.exec( param_string );\n\t\t\tif( results == null ) return \"\";\n\t\t\telse return decodeURIComponent(results[1]);\n\t\t},\n\t\n\t\tgetTimeMs: function() {\n\t\t\treturn (new Date().getTime());\n\t\t},\n\t\n\t\tisValidInteger: function(val) {\n\t\t\t// returns true for 0, '0', 1, '1'. False for '', undefined\n\t\t\treturn !isNaN(parseInt(val));\n\t\t},\n\t\n\t\t//copied from bouncex.ibx\n\t\tisValidEmail: function(email) {\n\t\t\tvar regex = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t\treturn regex.test(email);\n\t\t},\n\t\n\t\tisValidUrl: function(url, type) {\n\t\t\t//JKMD: type could differentiate between absolute/relative, allow mailto links, etc\n\t\t\tvar regex = /^(http|https):\\/\\/(([a-zA-Z0-9$\\-_.+!*'(),;:&=]|%[0-9a-fA-F]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])) {3})|localhost|([a-zA-Z0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Z]{2,}))(:[0-9]+)?(\\/(([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*(\\/([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*)*)?(\\?([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?(\\#([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?)?$/;\n\t\t\treturn regex.test(url);\n\t\t},\n\t\n\t\tmakeQuerystring: function(o) {\n\t\t\tvar a=[],s='';\n\t\t\tfor(var k in o) {\n\t\t\t\tif(!o.hasOwnProperty(k)) continue;\n\t\t\t\ta.push(k+'='+encodeURIComponent(o[k]));\n\t\t\t}\n\t\t\treturn a.join('&');\n\t\t},\n\t\n\t\tmergeObject: function () {\n\t\t\tvar o = {};\n\t\t\tfor (var k in arguments) {\n\t\t\t\tvar a = arguments[k];\n\t\t\t\tif (typeof a == 'object') {\n\t\t\t\t\tfor (var k in a) {\n\t\t\t\t\t\tif (a.hasOwnProperty(k)) o[k] = a[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn o;\n\t\t}\n\t};\n\t\n\tbouncex.util.cookies = {\n\t\n\t\tdomain: window.bouncex.cookie_domain,\n\t\n\t\tcreate: function(obj){\n\t\t\tdefaults = {\n\t\t\t\tname : '',\n\t\t\t\tvalue : '',\n\t\t\t\tdomain : false,\n\t\t\t\tdays : 14\n\t\t\t};\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\n\t\t\tif (!obj.name || !obj.value) { return false; }\n\t\n\t\t\tvar date = new Date();\n\t\t\tdate.setTime(date.getTime() + obj.days * 24 * 60 * 60 * 1e3);\n\t\t\tvar exp = '; expires=' + date.toGMTString();\n\t\n\t\t\tvar cookieString = obj.name + '=' + obj.value + exp + '; path=/;';\n\t\t\tif (obj.domain){\n\t\t\t\tcookieString += 'domain=' + obj.domain + ';';\n\t\t\t}\n\t\t\tdocument.cookie = cookieString;\n\t\t},\n\t\n\t\tdestroy: function (name) {\n\t\t\tthis.create({\n\t\t\t\tname : name,\n\t\t\t\tdays : -1,\n\t\t\t});\n\t\t},\n\t\n\t\tread: function (name) {\n\t\t\t//return this.multi.get(name);\n\t\t\tvar t = name + \"=\", vars = document.cookie.split(\";\");\n\t\t\tfor (var r = 0; r < vars.length; r++) {\n\t\t\t\tvar i = vars[r];\n\t\t\t\twhile (i.charAt(0) == \" \")i = i.substring(1, i.length);\n\t\t\t\tif (i.indexOf(t) == 0)return i.substring(t.length, i.length);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n\t\n\t// if utk is already defined persist whatever listeners it has before wipe\n\tvar previousListeners = bouncex.utk && bouncex.utk.listeners;\n\t\n\tbouncex.utk = {\n\t\t\n\t\tlisteners: previousListeners || {},\n\t\n\t\taddMetadata: function(obj) {\n\t\t\tvar m = this.getMetadata();\n\t\t\treturn bouncex.util.mergeObject(obj, m);\n\t\t},\n\t\n\t\tgetMetadata: function() {\n\t\t\treturn {\n\t\t\t\t'page:type': this.getPageType(),\n\t\t\t\t'customer:hasconverted': (bouncex.cookie.lc?1:0)\n\t\t\t};\n\t\t},\n\t\n\t\tgetPageType: function() {\n\t\t\treturn \"\";\n\t\t},\n\t\n\t\thoverItem: function(obj) {\n\t\t\tvar defaults = {\n\t\t\t\teventName: 'hover item',\n\t\t\t\titemTracking: false,\n\t\t\t\tselector: '',\n\t\t\t\tmaxItems: 5,\n\t\t\t\ttimeoutMs: 1000,\n\t\t\t\tgetItemData: function(el) { return null; },\n\t\t\t};\n\t\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\n\t\t\t//validation here\n\t\t\tif (!obj.selector) { return null; }\n\t\n\t\t\t//register the tracker\n\t\t\tobj.stop = removeHoverTracking;\n\t\t\tvar trackerId = bouncex.utk.register(obj);\n\t\t\tvar timeout;\n\t\t\tvar ids = [];\n\t\n\t\t\tfunction onMouseenter() {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\tvar el = this;\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\tvar item = obj.getItemData(el);\n\t\t\t\t\tif (!item.id) { return; }\n\t\t\t\t\t//if not already tracked\n\t\t\t\t\tif (ids.indexOf(item.id) === -1) {\n\t\t\t\t\t\t//add id to list of tracked items\n\t\t\t\t\t\tids.push(item.id);\n\t\t\t\t\t\t//track the event\n\t\t\t\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\t\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t\t\t\t\t//track the item\n\t\t\t\t\t\tif (obj.itemTracking) {\n\t\t\t\t\t\t\tbouncex.utk.trackItem(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//check limits\n\t\t\t\t\t\tif (ids.length >= obj.maxItems) {\n\t\t\t\t\t\t\tremoveHoverTracking();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, obj.timeoutMs);\n\t\t\t}\n\t\n\t\t\tfunction onMouseleave() {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t}\n\t\n\t\t\tfunction addHoverTracking() {\n\t\t\t\tjQuery(document).on('mouseenter.bx-tracking-hover.' + trackerId, obj.selector, onMouseenter);\n\t\t\t\tjQuery(document).on('mouseleave.bx-tracking-hover.' + trackerId, obj.selector, onMouseleave);\n\t\t\t}\n\t\n\t\t\tfunction removeHoverTracking() {\n\t\t\t\tjQuery(document).off('mouseenter.bx-tracking-hover.' + trackerId);\n\t\t\t\tjQuery(document).off('mouseleave.bx-tracking-hover.' + trackerId);\n\t\t\t\tclearTimeout(timeout);\n\t\t\t}\n\t\n\t\t\taddHoverTracking();\n\t\t\treturn trackerId;\n\t\t},\n\t\n\t\tisIdentified: function(){\n\t\t\treturn !!(bouncex.cookie.uid || bouncex.getBounceCookie('__ibxu'));\n\t\t},\n\t\n\t\tquickviewItem: function(obj) {\n\t\t\tvar defaults = {\n\t\t\t\teventName: 'view item',\n\t\t\t\titemTracking: false,\n\t\t\t\tselector: '',\n\t\t\t\tgetItemData: function(el) { return null; }\n\t\t\t};\n\t\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\t\t//validation here\n\t\t\tif (!obj.selector) { return null; }\n\t\n\t\t\tvar prevVisible = false,\n\t\t\tvisible;\n\t\n\t\t\treturn bouncex.utk.setInterval({\n\t\t\t\tcallback: function() {\n\t\t\t\t\tvisible = jQuery(obj.selector).is(':visible');\n\t\t\t\t\tif (visible && !prevVisible) {\n\t\t\t\t\t\tvar item = obj.getItemData(obj.selector);\n\t\n\t\t\t\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\t\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t\t\t\t\t//track the item\n\t\t\t\t\t\tif (obj.itemTracking) {\n\t\t\t\t\t\t\tbouncex.utk.trackItem(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tprevVisible = visible;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\n\t\trequestEmail: function(obj) {\n\t\t\t//JKMD: bouncex.push right now automatically adds namespacing, which would mess up \"campaignid\"\n\t\t\tparams = {};\n\t\t\tfor (var k in obj) {\n\t\t\t\tif (obj.hasOwnProperty(k)){\n\t\t\t\t\tparams[k.toLowerCase()] = obj[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tevent_stream_report('requestemail', params);\n\t\t},\n\t\n\t\t//JKMD: long-term plan is to put all of our polling into a single setInterval\n\t\tsetInterval: function(obj) {\n\t\t\tvar defaults = {\n\t\t\t\tmilliseconds: 1000,\n\t\t\t\tcallback: function() { return null; }\n\t\t\t};\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\t\tvar intervalId = setInterval(obj.callback, obj.milliseconds);\n\t\n\t\t\tobj.stop = removeInterval;\n\t\t\tvar trackerId = bouncex.utk.register(obj);\n\t\t\tfunction removeInterval() {\n\t\t\t\tclearInterval(intervalId);\n\t\t\t}\n\t\t\treturn trackerId;\n\t\t},\n\t\n\t\ttrackItem: function(item) {\n\t\t\tif (typeof(item.id) === 'string'){\n\t\t\t\titem.id = item.id.trim().toLowerCase();\n\t\t\t}\n\t\t\tif (!this.validateItem(item)) {\n\t\t\t\t//bouncex.log('item failed validation', item);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\titem = bouncex.util.addNamespace(item, 'item');\n\t\t\tbouncex.push(['item', item]);\n\t\t},\n\t\n\t\ttrackItemInteraction: function(obj) {\n\t\t\tvar id = obj.item.id;\n\t\t\tif (typeof(id) === 'string'){\n\t\t\t\tid = id.trim().toLowerCase();\n\t\t\t}\n\t\t\tvar o = { 'item:id': id };\n\t\t\to = this.addMetadata(o);\n\t\t\tbouncex.push([obj.eventName, o]);\n\t\t},\n\t\n\t\ttrackListPage: function(obj){\n\t\t\tvar defaults = {\n\t\t\t\teventName: 'view ' + this.getPageType(),\n\t\t\t\tmaxItems: 6,\n\t\t\t\tselector: '',\n\t\t\t\ttitle: '',\n\t\t\t\turl: jQuery('link[rel=canonical]').attr('href') || window.location.href.split('?')[0],\n\t\t\t\titemTracking : false,\n\t\t\t\tgetItemData: function(el) { return null;},\n\t\t\t\textraEventData: {}\n\t\t\t};\n\t\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\n\t\t\tvar items = jQuery(obj.selector);\n\t\t\tif (!items || !items.length){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar itemsTracked = 0;\n\t\t\tvar itemIds = [];\n\t\t\tfor (var i = 0; i < items.length && itemsTracked < obj.maxItems; i++) {\n\t\t\t\tvar item = obj.getItemData(items[i]);\n\t\t\t\tif (item.id){\n\t\t\t\t\tif (typeof(item.id) === 'string'){\n\t\t\t\t\t\titem.id = item.id.trim().toLowerCase();\n\t\t\t\t\t}\n\t\t\t\t\t// add id to list\n\t\t\t\t\titemIds.push(item.id);\n\t\t\t\t\tif (obj.itemTracking){\n\t\t\t\t\t\t//track full item\n\t\t\t\t\t\tthis.trackItem(item);\n\t\t\t\t\t}\n\t\t\t\t\titemsTracked++;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tvar o = {'items:ids' : itemIds.join(','), 'page:url' : obj.url};\n\t\t\tif (obj.title){\n\t\t\t\to['page:title'] = obj.title;\n\t\t\t}\n\t\t\to = this.addMetadata(o);\n\t\t\to = bouncex.util.mergeObject(o, obj.extraEventData);\n\t\t\tbouncex.push([obj.eventName, o]);\n\t\t},\n\t\n\t\ttrackUser: function(user) {\n\t\t\tif (!user.email && !user.emailHash) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (user.email && !bouncex.util.isValidEmail(user.email)){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar params = bouncex.util.addNamespace(user, 'user');\n\t\t\tif (user.email) {\n\t\t\t\tparams['user:email'] = user.email;\n\t\t\t}\n\t\t\tif (user.emailHash) {\n\t\t\t\tparams['user:emailhash'] = user.emailHash;\n\t\t\t}\n\t\t\tif (user.campaignId) {\n\t\t\t\tparams['campaignid'] = user.campaignId;\n\t\t\t}\n\t\t\tparams['user:gcr'] = (bouncex && bouncex.cookie) ? bouncex.cookie.gcr : 99;\n\t\t\tparams['agent'] = 'js';\n\t\t\tparams['eq'] = 1;\n\t\n\t\t\tevent_stream_report('user', params);\n\t\n\t\t\tbouncex.cookie.uid = 1;\n\t\t\tsetBounceCookie();\n\t\t\t//legacy support\n\t\t\tbouncex.util.cookies.create({\n\t\t\t\tname: '__ibxu',\n\t\t\t\tvalue : '1',\n\t\t\t\tdomain : '.' + bouncex.util.cookies.domain,\n\t\t\t\tdays : 365,\n\t\t\t});\n\t\n\t\t},\n\t\n\t\tvalidateItem: function(item) {\n\t\t\t// console.log('validating',item);\n\t\t\tif (!item) { return false; }\n\t\t\tif (!item.id) { return false; }\n\t\t\tif (!item.copy) { return false; }\n\t\t\tif (!item.imageurl || !bouncex.util.isValidUrl(item.imageurl)) { return false; }\n\t\t\tif (!item.url || !bouncex.util.isValidUrl(item.url)) { return false; }\n\t\t\t// console.log('passed validation');\n\t\t\treturn true;\n\t\t},\n\t\n\t\tviewItem: function(obj) {\n\t\t\tvar defaults = {\n\t\t\t\teventName: 'view item',\n\t\t\t\titemTracking: true,\n\t\t\t\tgetItemData: function() { return null; }\n\t\t\t};\n\t\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\n\t\t\tvar item = obj.getItemData();\n\t\n\t\t\tif (obj.itemTracking) {\n\t\t\t\tthis.trackItem(item);\n\t\t\t}\n\t\n\t\t\tif (item.id) {\n\t\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t\t} else {\n\t\t\t\t//bouncex.log('no item id', obj.eventName, item);\n\t\t\t}\n\t\t},\n\t\n\t\t//keeping track of the listeners inside tracking\n\t\tregister: function(obj) {\n\t\t\tvar id = bouncex.util.getTimeMs() + Math.random();\n\t\t\tbouncex.utk.listeners[id] = obj;\n\t\t\treturn id;\n\t\t},\n\t\n\t\t//remove single tracker\n\t\tstop: function(id) {\n\t\t\tif (bouncex.utk.listeners.hasOwnProperty(id)) {\n\t\t\t\tbouncex.utk.listeners[id].stop();\n\t\t\t\tdelete bouncex.utk.listeners[id];\n\t\t\t}\n\t\t},\n\t\n\t\t//remove all listeners\n\t\tstopAll: function() {\n\t\t\tfor (var id in bouncex.utk.listeners) {\n\t\t\t\tbouncex.utk.stop(id);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tbouncex.utk.cart = {\n\t\n\t\tgetCart: function() {\n\t\t\tif (this.state) {\n\t\t\t//cached here once we look it up or save\n\t\t\treturn this.state;\n\t\t}else if (this.config.storeCartVariable && bouncex.vars[this.config.storeCartVariable]) {\n\t\t\t//look up from cvar if it exists\n\t\t\tthis.state = JSON.parse(bouncex.vars[this.config.storeCartVariable]);\n\t\t\treturn this.state;\n\t\t}else {\n\t\t\treturn {};\n\t\t}\n\t},\n\t\n\tgetCount: function(){\n\t\treturn bouncex.vars[this.config.cartCountVariable];\n\t},\n\t\n\tinferCount: function(cart) {\n\t\t\t// return cart.count if specified and valid\n\t\t\tif (bouncex.util.isValidInteger(cart.count)) {\n\t\t\t\treturn parseInt(cart.count);\n\t\t\t} else if (cart.items) {\n\t\t\t\t// deduce from items length (using qty property if specified)\n\t\t\t\tvar count = 0;\n\t\t\t\tfor (var i = 0; i < cart.items.length; i++) {\n\t\t\t\t\tvar qty = parseInt(cart.items[i].qty) || 1;\n\t\t\t\t\tcount += qty;\n\t\t\t\t}\n\t\t\t\treturn count;\n\t\t\t}else if (bouncex.util.isValidInteger(this.getCount())){\n\t\t\t\treturn parseInt(this.getCount());\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\t\n\t\tinit: function(obj) {\n\t\t // console.log('init');\n\t\t\tvar defaults = {\n\t\t\t\t// lastReplenishment: false,\n\t\t\t\tstoreCartVariable: 'cart',\n\t\t\t\tcartCountVariable: 'cart_qty',\n\t\t\t\tmaxVariableSize: 400,\n\t\t\t\tstoreValues: ['count', 'items'],\n\t\t\t\tmaxItems: 10\n\t\t\t};\n\t\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\t\tthis.config = obj;\n\t\n\t\t\t//JKMD: should we do this via init, or just override explicitly...?\n\t\t\tthis.replenish = obj.replenish || this.replenish;\n\t\t\tthis.validateReplenishment = obj.validateReplenishment || this.validateReplenishment;\n\t\t\t// console.log('this',this);\n\t\t\t// console.log('this.validateReplenishment',this.validateReplenishment);\n\t\t\tthis.reportReplenishment = obj.reportReplenishment || this.reportReplenishment;\n\t\n\t\t\tthis.initFromQuerystring();\n\t\t\tthis.reportReplenishment();\n\t\t},\n\t\n\t\tinitFromQuerystring: function() {\n\t\t // console.log('init from query string...');\n\t\t  \n\t\t\tvar bx_cart = bouncex.util.getParam('bx_cart');\n\t\t\tvar cart = {};\n\t\n\t\t\tif (bx_cart) {\n\t\t\t\t//JKMD: support base64\n\t\t\t\tif (bx_cart.charAt(0) !== '{') {\n\t\t\t\t\tbx_cart = atob(bx_cart);\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tcart = JSON.parse(bx_cart);\n\t\t\t\t} catch(e) { console.log(e); return false; }\n\t\t\t} else {\n\t\t\t  // console.log('bx_cart returning false');\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tif (!this.validateReplenishment(cart)) {\n\t\t\t  // console.log('validate replen returning false...')\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tthis.save(cart);\n\t\t\treturn this.replenish(cart);\n\t\t},\n\t\n\t\treplenish: function(cart) {\n\t\t\treturn null;\n\t\t},\n\t\n\t\tsave: function(cart) {\n\t\t\tif (!cart) { return false; }\n\t\t\tthis.state = cart;\n\t\t\tif (this.config.storeCartVariable) {\n\t\t\t\tvar storedCart = {};\n\t\t\t\tif (cart.count === 0) {\n\t\t\t\t\t// if count is 0, don't store any other info\n\t\t\t\t\tstoredCart = { count: 0 };\n\t\t\t\t}else{\n\t\t\t\t\t//store values specified in settings\n\t\t\t\t\tfor (var i = 0; i < this.config.storeValues.length; i++) {\n\t\t\t\t\t\tvar k = this.config.storeValues[i];\n\t\t\t\t\t\tif (cart.hasOwnProperty(k)) {\n\t\t\t\t\t\t\tstoredCart[k] = cart[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar cartString = JSON.stringify(storedCart);\n\t\t\t\tif (cartString.length <= this.config.maxVariableSize) {\n\t\t\t\t\tbouncex.setv(this.config.storeCartVariable, cartString);\n\t\t\t\t\tsetBounceCookie();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\ttrack: function(cart) {\n\t\t\tvar trackCart = bouncex.util.mergeObject(cart);\n\t\t\tif (trackCart.items) trackCart.items = JSON.stringify(trackCart.items);\n\t\t\tif (trackCart.ids) trackCart.ids = trackCart.ids.join(',');\n\t\t\ttrackCart = bouncex.util.addNamespace(trackCart, 'cart');\n\t\t\tbouncex.push(['cart', trackCart]);\n\t\t},\n\t\n\t\tupdate: function (obj) {\n\t\t\tvar cart = {};\n\t\n\t\t\tif (obj.newItem) {\n\t\t\t\t//if partial, merge new item with stored items\n\t\t\t\tvar oldCart = this.getCart();\n\t\t\t\tvar allItems = oldCart.items || [];\n\t\t\t\tallItems.push(obj.newItem);\n\t\t\t\tobj.items = allItems;\n\t\t\t}\n\t\n\t\t\t// pass relevant properties to cart\n\t\t\tcart.count = obj.count;\n\t\t\tif (obj.items && obj.items.length) { cart.items = obj.items; }\n\t\t\tif (obj.ids && obj.ids.length) { cart.ids = obj.ids; }\n\t\t\tif (obj.token) { cart.token = obj.token; }\n\t\t\tif (obj.value) { cart.value = obj.value; }\n\t\n\t\n\t\t\t//set count\n\t\t\tcart.count = this.inferCount(cart);\n\t\n\t\t\t// remove items from beginning of items array if over limit\n\t\t\tif (this.config.maxItems && cart.items && cart.items.length > this.config.maxItems) {\n\t\t\t\tcart.items = cart.items.slice(cart.items.length - this.config.maxItems);\n\t\t\t}\n\t\n\t\t\t//auto parse ids from items variable if no ids specified\n\t\t\tif (!cart.ids && cart.items) {\n\t\t\t\tvar ids = [];\n\t\t\t\tfor (var i = 0; i < cart.items.length; i++) {\n\t\t\t\t\tif (cart.items[i].id) {\n\t\t\t\t\t\tcart.ids.push(cart.items[i].id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ids.length) { cart.ids = ids; }\n\t\t\t}\n\t\n\t\t\t// save in cart.state, and in cvar if specified\n\t\t\tthis.save(cart);\n\t\t\t//track cart\n\t\t\tthis.track(cart);\n\t\t\t//fire add to cart event if new item or addToCart flag\n\t\t\tif (obj.newItem || obj.addToCart){\n\t\t\t\tbouncex.push(['add to cart', bouncex.utk.getMetadata()]);\n\t\t\t}\n\t\t},\n\t\n\t\tvalidateReplenishment: function(cart) {\n\t\t // console.log('running default validate');\n\t\t\tvar cartCount = bouncex.utk.cart.getCount();\n\t\t\tif (bouncex.util.isValidInteger(cartCount) && cartCount > 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tif (!cart) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tif (!cart.value && !cart.token && !cart.items) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t},\n\t\n\t\treportReplenishment: function() {\n\t\t\tvar bx_replen = bouncex.util.getParam('bx_replen');\n\t\t\t// console.log('checking for bx_replen...',bx_replen);\n\t\t\tif (bx_replen) {\n\t\t\t  // console.log('reporting replen in 1 second...');\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t // console.log('reporting replen');\n\t\t\t\t\tvar cartCount = bouncex.utk.cart.getCount();\n\t\t\t\t\tbouncex.push(['replenish', {'cart:count': cartCount, 'cart:success': cartCount > 0}]);\n\t\t\t\t}, 1100);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tbouncex.utk.getPageType = function() {\n\t\tvar mobileSite = (window.location.href.indexOf('mobile') > -1);\n\t\tvar giftCard = jQuery('#productName').val();\n\t\tvar soldout = jQuery('.wcs-item-not-available');\n\t\tvar categoryByUtag = false;\n\t\t\n\t\t/* exclude Not Eligible Online */\n\t  if (jQuery('.not-sellable-messg span:contains(NOT SELLABLE ONLINE) , #wcs-productprice:contains(NOT SELLABLE ONLINE)').length) {\n\t\treturn false;\n\t  }\n\t\t/* if a mobile product page is different, you could make that it's own page type in here */\n\t\tif (window.location.pathname.substring(0,4) == '/usa' && jQuery('meta[property=\"og:type\"]').length > 0 && jQuery('meta[property=\"og:type\"]').attr('content') === 'product' && jQuery('.wcs-item-not-available').length === 0 && jQuery('#wcs-productdescval').text().toLowerCase().indexOf('gift card') === -1 && window.location.pathname.substring(0,4) == '/usa' || jQuery('#productDetailsButton').length > 0) {\n\t\t\treturn 'product';\n\t\t}\n\t\tif (typeof(utag) !== \"undefined\"){\n\t\t // console.log('utag found...');\n\t\t  categoryByUtag  = utag.data && (utag.data.page_type === 'category' || utag.data.Page_Section2 === 'CategoryListing');\n\t\t}\n\t\t\n\t\tif (window.location.pathname.substring(0,4) == '/usa' && jQuery('#pageTemplate').length > 0 && (jQuery('#pageTemplate').val().indexOf('Category') > -1 || jQuery('#pageTemplate').val() === 'ProductListing') || jQuery('.category-container').length === -1 || categoryByUtag  || (window.location.pathname.indexOf('clp') > -1) || (window.location.pathname.indexOf('plp') > -1)) {\n\t\t\treturn 'category';\n\t\t}\n\t\tif (jQuery('.product-delivery.currently-unavailable-msg').length === 0 && window.location.pathname.substring(0,4) == '/usa' && window.location.href.indexOf('/virtual-try-on') === -1 &&  mobileSite &&(jQuery('#pdp').length > 0 || jQuery('#producttype').length > 0 && jQuery('#producttype').val() !== 'Home')) {\n\t\t  if (jQuery('#productName').val() && jQuery('#productName').val().indexOf('GIFT CARD') > -1){\n\t\t\treturn '';\n\t\t  }\n\t\t\treturn 'mobile-product';\n\t\t}\t\n\t\tif (window.location.pathname.substring(0,4) == '/usa' &&  jQuery('#pageType').length && jQuery('#pageType').val() === 'SearchResults' || window.location.href.indexOf('SearchDisplay') !== -1) {\n\t\t\treturn 'search';\n\t\t}\n\t\tif (document.location.pathname.indexOf('/cart') !== -1) {\n\t\t\treturn 'cart';\n\t\t}\n\t\t\n\t\tif(jQuery('meta[name=\"title\"]').prop('content').toLowerCase().indexOf('custom and personalized sunglasses') > -1){\n\t\t  return 'customize-page';\n\t\t}\n\t\n\t\treturn '';\n\t};\n\t\n\t\n\tbouncex.utk.validateReplenishment = function(cart) {\n\t  // console.log('non-default validating replenishment...',cart);\n\t\n\t\tif (!cart) {\n\t\t  \n\t\t\treturn false;\n\t\t}\n\t\n\t\tif (!cart.value && !cart.token && !cart.items) {\n\t\t\treturn false;\n\t\t}\n\t\n\t\treturn true;\n\t};\n\t\n\tbouncex.utk.cart.reportReplenishment = function() {\n\t\tvar bx_replen = bouncex.util.getParam('bx_replen');\n\t\tif (bx_replen) {\n\t\t\tsetTimeout(function() {\n\t\t\t\tvar cartCount = jQuery('.D_CartPage_Prods_View').length || bouncex.utk.cart.getCount();\n\t\n\t\t\t\tbouncex.push(['cart replenish', {\n\t\t\t\t\t'cart:count': cartCount,\n\t\t\t\t\t'cart:success': cartCount > 0\n\t\t\t\t}]);\n\t\t\t}, 1500);\n\t\t}\n\t}\n\t\n\t//***********************  Replenishment Start 1***********************//\n\tvar trackEmptyCart = function() {\n\t\n\t\n\t\t// console.log(jQuery('#wcs-cart-container').length,(typeof jQuery('#wcs-cart-container').find('#tcount').val() == \"undefined\"));\n\t\tif (jQuery('#wcs-cart-container').length && (typeof jQuery('#wcs-cart-container').find('#tcount').val() == \"undefined\")) {\n\t\t\treturn;\n\t\t}\n\t\n\t\tvar currentCount = bouncex.utk.cart.getCount();\n\t\n\t\tvar bx_replen = bouncex.util.getParam('bx_replen');\n\t\tif (bx_replen || window.location.pathname === '/ShopCartDisplayView') {\n\t\t\tcurrentCount = jQuery('.D_CartPage_Prods_View').length || bouncex.utk.cart.getCount();\n\t\t}\n\t\t// \tconsole.log('track empty cart - current, old: ',currentCount,bouncex.utk.oldCount);\n\t\n\t\tif (currentCount === 0 && bouncex.utk.oldCount > 0) {\n\t\t\t// console.log('updating empty cart');\n\t\n\t\t\tbouncex.utk.cart.update({\n\t\t\t\tcount: 0,\n\t\t\t\taddToCart: false\n\t\t\t});\n\t\t}\n\t\tbouncex.utk.oldCount = currentCount;\n\t};\n\t\n\tvar processCartAjax = function(event, xhr, setting){\n\t// \tconsole.log('setting.url',setting.url);\n\t\tvar cartIds = bouncex.utk.cart.getCart().ids || [];\n\t\tvar id = window.location.href.substring(window.location.href.lastIndexOf('/')+1).split('?')[0].replace('#','');\n\t\tcartIds = cartIds.concat([id]);\n\t\tif (setting.url.indexOf('AjaxOrderItemAdd') > -1 ) { // adding regular items\n\t\t\t// console.log('bx ajax complete #1 - on ajax complete Regular');\n\t\t\tif (setting.url.indexOf('/prescription-sunglasses') !== -1 || window.location.href.indexOf('/prescription-sunglasses') !== -1) { // prescription glasses\n\t\t\t// \tconsole.log('bx - prescription-sunglasses');\n\t\t\t\tvar fullString = (window.location.href.indexOf('/mobile')>-1? setting.url.split('?')[1] : setting.data);\n\t\t\t\tbouncex.utk.cart.update({\n\t\t\t\t\t\ttoken: bouncex.utk.cart.getCart().token,\n\t\t\t\t\t\tnewItem: {fullString: fullString},\n\t\t\t\t\t\tids: cartIds,\n\t\t\t\t\t\taddToCart: true,\n\t\t\t\t\t});\t\t\t\t\n\t\t\t} else {\n\t\t\t// \tconsole.log('bx - prescrption-sunglasses - ELSE');\t\n\t\t\t\tvar catEntryId = bouncex.util.getParam('catEntryId', ((typeof utag_data !== 'undefined' && utag_data.Page_DeviceType==='mobile')? (setting.url.split('?')[1]) : '?'+setting.data));\n\t\t\t\t\n\t\t\t\tbouncex.utk.cart.update({\n\t\t\t\t\ttoken: bouncex.utk.cart.getCart().token,\n\t\t\t\t\tnewItem: {catEntryId:catEntryId},\n\t\t\t\t\tids: cartIds,\n\t\t\t\t\taddToCart: true,\n\t\t\t\t}); \n\t\t\t}\n\t\n\t\t} else if (setting.url.indexOf('AjaxDynamicKitOrderItemAdd') > -1  && setting.data[0] === '{' ) { // adding remix items\n\t\t\t// console.log('bx - ajax complete #2, on ajax complete Remix');\n\t\n\t\t\tvar postData = JSON.parse(setting.data);\n\t\t\tvar remixUrl = (window.location.pathname+'?token='+postData.token).replace('/mobile/customize/','/customize/');\n\t\t\t// console.log('remixURL',remixUrl);\n\t\t\tvar items = bouncex.utk.cart.getCart().items || [];\n\t\t\t// console.log('items',items);\n\t\n\t\t\tbouncex.utk.cart.update({\n\t\t\t\tcount: items.length + 1,\n\t\t\t\titems: items,\n\t\t\t\tids: cartIds,\n\t\t\t\ttoken: remixUrl,\n\t\t\t\taddToCart: true,\n\t\t\t});\t\t\t\t\n\t\t} else if (setting.url.indexOf('MobileWishlistAddCmd') > -1 ) {\n\t\t\t// console.log('bx - ajax complete #4 Mobile Wishlist Add to Cart');\n\t\t\tvar catEntryId = bouncex.util.getParam('catEntryId', ((typeof utag_data !== 'undefined' && utag_data.Page_DeviceType==='mobile')? (setting.url.split('?')[1]) : '?'+setting.data));\n\t\t\tvar configurationId = bouncex.util.getParam('configurationId', ((typeof utag_data !== 'undefined' && utag_data.Page_DeviceType==='mobile')? (setting.url.split('?')[1]) : '?'+setting.data));\n\t\t\tif (catEntryId && !configurationId){\n\t\t\t\tbouncex.utk.cart.update({\n\t\t\t\t\ttoken: bouncex.utk.cart.getCart().token,\n\t\t\t\t\tnewItem: {catEntryId:catEntryId},\n\t\t\t\t\tids: cartIds,\n\t\t\t\t\taddToCart: true,\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t}\n\t};\n\t//***********************  Replenishment End 1***********************//\n\t\n\t\n\t//required setup: define init function. All tracking code should go in here\n\tbouncex.utk.init = function() {\n\t\t//Cancel any existing listeners. Crucial for Angular sites\n\t\t  bouncex.utk.stopAll();\n\t\t  \n\t\t  if (window.location.host !== 'www.ray-ban.com'){\n\t\t\treturn;\n\t\t  }\n\t\t  \n\t\t jQuery('input').not(':input[type=button], :input[type=submit], :input[type=reset], :input[type=hidden], :input[type=radio], :input[type=checkbox], :input[type=image], :input[type=password], :input[id*=wcs_userEmail], :input[id*=rb-input-Remail], :input[id*=rb-input-ConfirmEmail]').blur(function(){\n\t\t\tvar source = jQuery(this).attr(\"id\");\n\t\t\tbouncex.ibx.user( jQuery(this).val(), {__src: source } );\n\t\t});\n\t\n\t\n\t\tvar mobile = window.location.href.indexOf('mobile') > -1;\n\t\tvar customize = window.location.href.indexOf('customize') > -1;\n\t\n\t\tvar pageType = bouncex.utk.getPageType();\n\t\tvar isNotFerrari = window.location.href.indexOf('ferrari') === -1;\n\t\n\t\n\t\t//***********************  Replenishment Start 2***********************//\n\t\tbouncex.utk.cart.init({\n\t\t\tstoreCartVariable: 'cart',\n\t\t\tcartCountVariable: 'items_in_cart',\n\t\t\tmaxVariableSize: 600,\n\t\t\tstoreValues: ['items','ids','token','count'],\n\t\t\tmaxItems: 10,\n\t\t\treplenish: function(cart) {\n\t\t\t\tvar replenishInterval = setInterval(function() {\n\t\n\t\t\t\t\tif (jQuery('#wcs-cart-container').length && (typeof jQuery('#wcs-cart-container').find('#tcount').val() == \"undefined\")){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclearInterval(replenishInterval);\n\t\t\t\t\t\tif (bouncex.utk.cart.getCount() !== 0){\n\t\t\t\t\t\t\twindow.location.href = '/ShopCartDisplayView#bx_replen=true'; \n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!cart.items && cart.token) {\n\t\t\t\t\t\t\twindow.location.href = cart.token ;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} \t\t\t\n\t\t\t\t\t\tvar items = cart.items;\n\t\t\t\t\t\tvar itemsLength = cart.items.length;\n\t\n\t\t\t\t\t\tvar addItemToCart = function(pointer) {\n\t\t\t\t\t\t\tvar item = items[pointer];\n\t\t\t\t\t\t\tvar postData;\n\t\n\t\t\t\t\t\t\tif (item.catEntryId) {\n\t\t\t\t\t\t\t\tpostData = 'URL=ShopCartDisplayView&field1=0&storeId='+jQuery('#storeId').val()+'&calculateOrder=1&langId=-1&pageName=ProductPage&pgName=PDP&catEntryId=' + item.catEntryId + '&quantity=1';\n\t\t\t\t\t\t\t} else if (item.fullString) {\n\t\t\t\t\t\t\t\tpostData = item.fullString;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\t\t\t\t\n\t\n\t\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\t\ttype:'POST',\n\t\t\t\t\t\t\t\turl: window.location.protocol + '//www.ray-ban.com/usa/sunglasses/aviator/clv/AjaxOrderItemAdd?' + postData,\n\t\t\t\t\t\t\t\tcomplete: function (response) {\n\t\n\t\t\t\t\t\t\t\t\tpointer++;\n\t\t\t\t\t\t\t\t\tif (localStorage.bouncex) console.log('pointer, items.length',pointer,itemsLength);\n\t\t\t\t\t\t\t\t\tif (pointer < itemsLength) {\n\t\t\t\t\t\t\t\t\t\taddItemToCart(pointer);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (localStorage.bouncex) \tconsole.log('redirecting to replen link');\n\t\t\t\t\t\t\t\t\t\twindow.location.href = '/ShopCartDisplayView#bx_replen=true'; \n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\t\taddItemToCart(0);\n\t\t\t\t\t}\n\t\t\t\t},300);\n\t\t\t},\n\t\t\tvalidateReplenishment : function(cart) {\n\t\t// console.log('non-default validating replenishment...',cart);\n\t  \n\t\t  if (!cart) {\n\t\t\t\n\t\t\t  return false;\n\t\t  }\n\t  \n\t\t  if (!cart.value && !cart.token && !cart.items) {\n\t\t\t  return false;\n\t\t  }\n\t  \n\t\t  return true;\n\t  },\n\t\t});\n\t\t\n\t\tif (window.location.href.indexOf('bx_cart') === -1){\n\t\t\tbouncex.utk.oldCount = bouncex.utk.cart.getCart().count || 0;\n\t\t\tbouncex.utk.setInterval({\n\t\t\t  callback : trackEmptyCart,\n\t\t  });\t\n\t  \n\t\t  jQuery(document).on('ajaxComplete.bx-replen', function(event, xhr, setting) {\n\t\t\t  try {\n\t\t\t\t  processCartAjax(event,xhr,setting);\n\t\t\t  } catch (e) { };\n\t\t  });\n\t\t}\n\t\t//***********************  Replenishment End 2***********************// \n\t\n\t\n\t\tif (pageType == 'mobile-product' && isNotFerrari){\n\t\t\tif (customize){\n\t\t\t// \tconsole.log('mobile,custom');\n\t\t\t// \tconsole.log(jQuery('#priceField').eq(0).text());\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tbouncex.utk.viewItem({\n\t\t\t\t\t\tgetItemData: function() {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: window.location.href.substring(window.location.href.lastIndexOf('/')+1).split('?')[0].replace('#',''),\n\t\t\t\t\t\t\t\tcopy: 'CUSTOM ' + jQuery('#modelTitle').text().toUpperCase(),\n\t\t\t\t\t\t\t\tsubcopy: jQuery('#box-id .wcs-half-top').text().trim(),\n\t\t\t\t\t\t\t\timageurl: (jQuery('#thumbPreload1').attr('src') || \"\").replace(/\\d+-rayban/, '0-rayban'),\n\t\t\t\t\t\t\t\tcategory: 'custom',\n\t\t\t\t\t\t\t\turl: window.location.href.replace(/usa\\/mobile/,'usa').split('?')[0], /* using this instead of canonical to fix canonical issue with two colors on one PDP*/\n\t\t\t\t\t\t\t\tprice: (jQuery('.previewPrice').eq(0).text() || \"\").replace(/[^0-9.]/g, '')\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},5000);\n\t\t\t} else {\n\t\n\t\t\t  // \tconsole.log('mobile,!custom');\n\t\t\t\tvar category = jQuery('dt:contains(Shape)').next('dd').text().length ? jQuery('dt:contains(Shape)').next('dd').text().toLowerCase() : jQuery('.completeYourAviator span:contains(COMPLETE YOUR)').text().toLowerCase().replace('complete your','').trim();\n\t\t\t\tif (!category) category = window.location.href.match(/mobile\\/(.+?)\\//)[1];\n\t\t\t\t\n\t\t\t\tvar itemId = window.location.href.split('?')[0].match(/(RX_)?\\d+$/)[0];\n\t\t\t\tvar imageURL = (jQuery('#main-image-container .wcs-main-image:visible').length > 0? jQuery('#main-image-container .wcs-main-image:visible').attr('src').split('?')[0].replace(/fr$/, 'qt') : '');\n\t\t\t\timageURL = imageURL.indexOf('http') > -1? imageURL : window.location.protocol + imageURL;\n\t\t\t\t\n\t\t\t  // \tvar category = window.location.href.match(/mobile\\/(.+?)\\//);\n\t\t\t  \n\t\t\t\tif (/\\d+$/.test(itemId) && itemId.length > 7){\n\t\t\t\t\tbouncex.utk.viewItem({\n\t\t\t\t\t\tgetItemData: function() {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: itemId,\n\t\t\t\t\t\t\t\tcopy: jQuery('#productName').val().toUpperCase(),\n\t\t\t\t\t\t\t\tsubcopy: jQuery('#wcs-product-details-overlay .wcs-half-top').text().trim(),\n\t\t\t\t\t\t\t\timageurl: imageURL,\n\t\t\t\t\t\t\t\tcategory: category,\n\t\t\t\t\t\t\t\turl: window.location.href.replace(/usa\\/mobile/,'usa').split('?')[0], /* using this instead of canonical to fix canonical issue with two colors on one PDP*/\n\t\t\t\t\t\t\t\tprice: (jQuery('.previewPrice').eq(0).text() || \"\").replace(/[^0-9.]/g, ''),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t  }\n\t\t  }\n\t\t\n\t\t  if (pageType == 'product' && isNotFerrari){\n\t\t\tvar URL;\n\t\t\tif(window.location.href.split('?')[0].indexOf('https') == -1){\n\t\t\t  URL = window.location.href.split('?')[0].replace('http','https');\n\t\t\t}else{\n\t\t\t  URL = window.location.href.split('?')[0];\n\t\t\t}\n\t\t\t\n\t\t\t  if (customize){\n\t\t\t\t  setTimeout(function() {\n\t\t\t\t\t  bouncex.utk.viewItem({\n\t\t\t\t\t\t  getItemData: function() {\n\t\t\t\t\t\t\t  return {\n\t\t\t\t\t\t\t\t  id: window.location.href.substring(window.location.href.lastIndexOf('/')+1).split('?')[0].replace('#',''),\n\t\t\t\t\t\t\t\t  copy: 'CUSTOM ' + jQuery('#modelTitle').text().toUpperCase(),\n\t\t\t\t\t\t\t\t  subcopy: jQuery('#box-id .wcs-half-top').text().trim(),\n\t\t\t\t\t\t\t\t  imageurl: (jQuery('#thumbPreload1').attr('src') || \"\").replace(/\\d+-rayban/, '0-rayban').replace('http','https'),\n\t\t\t\t\t\t\t\t  category: 'custom',\n\t\t\t\t\t\t\t\t  url: URL, /* using this instead of canonical to fix canonical issue with two colors on one PDP*/\n\t\t\t\t\t\t\t\t  price: jQuery('#priceField').eq(0).text().replace(/[^0-9.]/g, '')\t\t\t\t\t\n\t\t\t\t\t\t\t  };\n\t\t\t\t\t\t  }\n\t\t\t\t\t  });\n\t\t\t\t  },8000);\n\t  \n\t\t\t  } else {\n\t\n\t\t\t\t  var imgUrl = jQuery('#main-image-container .wcs-main-image:visible').length > 0? jQuery('#main-image-container .wcs-main-image:visible').attr('src').split('?')[0].replace(/fr$/, 'qt') : '';\n\t\t\t\t  \n\t\t\t\t  var itemId = window.location.href.split('?')[0].match(/(RX_)?\\d+$/)[0];\n\t\t\t\t  if (/\\d+$/.test(itemId) && itemId.length > 7){\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t bouncex.utk.viewItem({\n\t\t\t\t\t\t  getItemData: function() {\n\t\t\t\t\t\t\t  return {\n\t\t\t\t\t\t\t\t  id:  itemId,\n\t\t\t\t\t\t\t\t  copy: jQuery('#productName').val().toUpperCase(),\n\t\t\t\t\t\t\t\t  subcopy: jQuery('.more-block .wcs-half-top').text().trim(),\t\n\t\t\t\t\t\t\t\t  imageurl:imgUrl.indexOf('https') > -1 ? imgUrl.replace(/([^:]\\/)\\/+/g, \"$1\") : 'https:' + imgUrl.replace(/([^:]\\/)\\/+/g, \"$1\"),\n\t\t\t\t\t\t\t\t  category: jQuery('.breadCrumbLabel:eq(-1)').text().trim().toLowerCase(),\n\t\t\t\t\t\t\t\t  url: URL, /* using this instead of canonical to fix canonical issue with two colors on one PDP*/\n\t\t\t\t\t\t\t\t  price: jQuery('#wcs-productprice').eq(0).text().replace(/[^0-9.]/g, '')\n\t\t\t\t\t\t\t  };\n\t\t\t\t\t\t  }\n\t\t\t\t\t  }); \n\t\t\t\t\t },2000);\n\t\n\t\t\t\t  }\n\t\t\t\t\t\n\t\t\t\t  \n\t\t\t\t  bouncex.utk.quickviewItem({\n\t\t\t\t\t  selector: '.quickview-popup',\n\t\t\t\t\t  itemTracking: false,\n\t\t\t\t\t  getItemData: function(el) {\n\t\t\t\t\t\t  var j = jQuery(el);\n\t\t\t\t\t\t  return {\n\t\t\t\t\t\t\t  id: j.find('.wcs-main-image').first().attr('id').match(/\\d+$/)[0],\n\t\t\t\t\t\t  };\n\t\t\t\t\t  }\n\t\t\t\t  });\n\t  \n\t\t\t\t  bouncex.utk.hoverItem({\n\t\t\t\t\t  selector: '.ymal-no-border',\n\t\t\t\t\t  itemTracking: false,\n\t\t\t\t\t  getItemData: function(el) {\n\t\t\t\t\t  var j = jQuery(el);\n\t\t\t\t\t\t  return {\n\t\t\t\t\t\t\t  id: j.find('a').attr('href').split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\t\t  };\n\t\t\t\t\t  }\n\t\t\t\t  });\n\t\t\t  }\n\t\t  }\n\t\t  \n\t\t  \n\t\tif (pageType == 'customize-page' && isNotFerrari){\n\t\t   //Custom event for remix category page\n\t\t  setTimeout(function(){\n\t\t\tif ( window.location.pathname === '/usa/customize' || window.location.pathname === '/usa/mobile/customize' ) {\n\t\t\t\t  bouncex.push(['view customize', bouncex.utk.getMetadata()]);\n\t\t\t}\n\t\t  },800);\n\t\t  \n\t\t}\n\t\n\t\t  if (pageType == 'category' && isNotFerrari){\n\t\n\t\t\t  if(mobile === true){\n\t\t\t\t\n\t\t\t\t  bouncex.utk.trackListPage({\n\t\t\t\t\t\tselector: 'div.rbBoxes div.rbBox a, div.plp-container div.categories a, div.plp-container div.categories a.D_PLP_Tiles:not(.disabled)',\n\t\t\t\t\t\titemTracking: false,\n\t\t\t\t\t\teventName:'view category',\n\t\t\t\t\t\ttitle: jQuery('.rb-slider-module-title').text(),\n\t\t\t\t\t\turl: jQuery('link[rel=canonical]').attr('href'),\n\t\t\t\t\t\tgetItemData: function(el){\n\t\t\t\t\t\t\t// var j = jQuery(el);\n\t\t\t\t\t\t\tvar urlArray = jQuery(el).attr('href').split('/')\n\t\t\t\t\t\t\t\t\t\tvar id = urlArray[urlArray.length -1]\n\t\t\t\t\t\t\t\t\t\t\tif (!isNaN(id) && id != \"\") {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tid: id\t   \n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}});\t\n\t\t\t\n\t\t\t  }else{\n\t\t\t\t\n\t\t\t  bouncex.utk.trackListPage({\n\t\t\t\t\t\tselector: 'div.rbBoxes div.rbBox a, div.plp-container div.categories a, div.plp-container div.categories a.D_PLP_Tiles:not(.disabled)',\n\t\t\t\t\t\titemTracking: false,\n\t\t\t\t\t\teventName:'view category',\n\t\t\t\t\t\ttitle: jQuery('.rb-slider-module-title').text(),\n\t\t\t\t\t\turl: jQuery('link[rel=canonical]').attr('href'),\n\t\t\t\t\t\tgetItemData: function(el){\n\t\t\t\t\t\t\t// var j = jQuery(el);\n\t\t\t\t\t\t\tvar urlArray = jQuery(el).attr('href').split('/')\n\t\t\t\t\t\t\t\t\t\tvar id = urlArray[urlArray.length -1]\n\t\t\t\t\t\t\t\t\t\t\tif (!isNaN(id) && id != \"\") {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tid: id\t   \n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}});;\t\t \n\t\n\t\t\t\t  //set quickview selector\n\t\t\t\t  var qVselector;\n\t\t\t\t  if(window.location.href.indexOf('prescription') > -1){\n\t\t\t\t\tqVselector = '#D_QuickView_Prod';\n\t\t\t\t  }else{\n\t\t\t\t\t qVselector = '#D_QuickView';\n\t\t\t\t  }\n\t\t\t\t  \n\t\t\t\tbouncex.utk.quickviewItem({\n\t\t\t\t\tselector: qVselector,\n\t\t\t\t\titemTracking: false,\n\t\t\t\t\tgetItemData: function(el) {\n\t\t\t\t\t\tvar j = jQuery(el);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: j.find('#D_QuickView_ShowDetails').attr('href').split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\tbouncex.utk.hoverItem({\n\t\t\t\t\tselector: '.plp-tile',\n\t\t\t\t\titemTracking: false,\n\t\t\t\t\t\tgetItemData: function(el){\n\t\t\t\t\t\t\tvar j = jQuery(el);\n\t\t\t\t\t\t\tvar prodLink = j.parent().attr('href');\n\t\t\t\t\tvar prodId;\n\t\t\t\t\t\n\t\t\t\t\tif(prodLink.lastIndexOf('?') > -1){\n\t\t\t\t\t  prodId =  prodLink.substring(prodLink.lastIndexOf(\"/\")+1,prodLink.lastIndexOf(\"?\"));\n\t\t\t\t\t}else{\n\t\t\t\t\t  prodId =  prodLink.substring(prodLink.lastIndexOf(\"/\")+1).match(/\\d+$/)[0];\n\t\t\t\t\t}\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: prodId,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t  }\n\t\n\t\t  }\n\t\t  \n\t\n\t\t  if (pageType === 'search' && isNotFerrari){\n\t\t\tif(mobile === true){\n\t\t\t  setTimeout(function(){\n\t\t\t\tbouncex.utk.trackListPage({\n\t\t\t\t\t\tselector:'.tilelink',\n\t\t\t\t\t\titemTracking: false,\n\t\t\t\t\t\teventName:'view search',\n\t\t\t\t\t\turl: window.location.href,\n\t\t\t\t\t\tgetItemData: function(el){\n\t\t\t\t\t\t\tvar j = jQuery(el);\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: j.attr('href').split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t},\n\t\t\t\t});\t\n\t\t\t  },800);\n\t\t\t  }else{\n\t\t\t  bouncex.utk.trackListPage({\n\t\t\t\t\tselector: '.plp-tile',\n\t\t\t\t\titemTracking: false,\n\t\t\t\t\teventName:'view search',\n\t\t\t\t\turl: window.location.href,\n\t\t\t\t\tgetItemData: function(el){\n\t\t\t\t\tvar j = jQuery(el);\n\t\t\t\t\tvar soldOut = jQuery('.unavailable-container');\n\t\t\t\t\t  if(j.find('.unavailable-container').length === 0){\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t  id: j.parent().attr('href').split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\t\t  };\n\t\t\t\t\t  }else{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t  }\n\t\t\t\t\t},\n\t\t\t});\t\n\t\t\t\n\t\t\tbouncex.utk.hoverItem({\n\t\t\t\t\tselector: '.plp-tile',\n\t\t\t\t\titemTracking: false,\n\t\t\t\t\tgetItemData: function(el) {\n\t\t\t\t\t\tvar j = jQuery(el);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: j.parent().attr('href').split('?')[0].match(/\\d+$/)[0],\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t  }\n\t\t  }\n\t  };\n\t\n\t  bouncex.utk.init();\n\t\n\t\n\t// }","cjs":"","miw":0,"mibcx":1,"te":1,"cart_rep":{"get":"","set":""},"ulpj":{"bxid":"espemailid"},"cus":"","miw_exclude":""},"etjson":null,"osre":true,"osru":"osr.bounceexchange.com/v1/osr/items","checkDfp":false,"spa":0,"spatm":1,"preinit_cjs":"","cpnu":"coupons.bounceexchange.com"}
;
		bouncex.tag = 'tag3';
		bouncex.$ = window.jQuery;
		bouncex.env = 'production';
		bouncex.restrictedTlds = {"casl":{"ca":1},"gdpr":{"ad":1,"al":1,"at":1,"ax":1,"ba":1,"be":1,"bg":1,"by":1,"xn--90ais":1,"ch":1,"cy":1,"cz":1,"de":1,"dk":1,"ee":1,"es":1,"eu":1,"fi":1,"fo":1,"fr":1,"uk":1,"gb":1,"gg":1,"gi":1,"gr":1,"hr":1,"hu":1,"ie":1,"im":1,"is":1,"it":1,"je":1,"li":1,"lt":1,"lu":1,"lv":1,"mc":1,"md":1,"me":1,"mk":1,"xn--d1al":1,"mt":1,"nl":1,"no":1,"pl":1,"pt":1,"ro":1,"rs":1,"xn--90a3ac":1,"ru":1,"su":1,"xn--p1ai":1,"se":1,"si":1,"sj":1,"sk":1,"sm":1,"ua":1,"xn--j1amh":1,"va":1,"tr":1}};
		bouncex.push = function(pushData) {
			bouncex.pushedData.push(pushData);
		}
		var script = document.createElement('script');
		script.setAttribute('src', '//assets.bounceexchange.com/assets/smart-tag/versioned/ijs_all_modules_cjs_min_e86b2f965c5c96c0740d4d9faec1ee38.js');

		var scriptAttrs = [{"Key":"id","Value":"c.js"},{"Key":"async","Value":"true"},{"Key":"data-gm","Value":"0"},{"Key":"data-fire","Value":"0"},{"Key":"data-apikey","Value":"2^HIykD"},{"Key":"data-cb","Value":"bouncex.dg.initPostDeviceGraph"},{"Key":"data-bx","Value":"1"}];
		if (scriptAttrs) {
			for (var i = 0; i < scriptAttrs.length; i++) {
				script.setAttribute(scriptAttrs[i].Key, scriptAttrs[i].Value);
			}
		}

		document.body.appendChild(script);
	}
}
if (document.readyState === "loading") {
	document.addEventListener("DOMContentLoaded", bxBootstrap);
} else {
	bxBootstrap();
}})();
extole.define("https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/api.js","https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/collection.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/logger.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/ajax.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/JSON.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/Timer.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/client/program.js https://origin.xtlo.net/type=core:clientId=512549859:coreAssetsVersion=1544591110285/common/client/token-store.js".split(" "),
function(g,l,q,m,r,n,t){function p(){var c=this,h,e,g,f,b;this.withRequestSummary=function(a){f=a;return c};this.withResponseSummary=function(a){b=a;return c};this.withStatusCode=function(a){g=a;return c};this.withMessage=function(a){e=a;return c};this.asDebug=function(){h="debug";return c};this.asInfo=function(){h="info";return c};this.asWarn=function(){h="warn";return c};this.asError=function(){h="error";return c};this.log=function(){if(!f.url.match(l.LOGGING_ENDPOINT)){var a=[];g&&a.push("Status "+
g);e&&a.push(e);l[h](a.join(" "),{request:f,response:b})}}}var u=/^\/api\/v\d\//,v=n.getProgramDomain();return new function(){function c(b,a,d){e("get",b,null,a,d)}function h(b,a,d){e("delete",b,null,a,d)}function e(b,a,d,k,c){k=k||function(){};c=c||{};a=n.getProtocol()+v+l(a);d=g.merge({},d);var e=g.merge({"Content-Type":"application/json","X-Extole-App":"javascript_sdk"},c.headers);c.noAuthorizationHeader||(e.Authorization=t.get());q({timeout:2E4,url:a,type:b,complete:function(a){var b=null;try{a=
m.parse(a)}catch(w){b=Error("Couldn't parse as JSON response from request, response: "+a),a=null}k&&k(b,a);a=g.merge({},a);a.timestamp=String((new Date).getTime());(new p).withRequestSummary(f).withResponseSummary(a).withMessage("Completed api request").asDebug().log()},error:function(a,b){try{var d=m.parse(this.response)}catch(x){d={statusText:this.statusText,status:b}}k&&k(d);a=g.merge({},d);a.timestamp=String((new Date).getTime());a=(new p).withRequestSummary(f).withResponseSummary(a);b=String(b||
d.http_status_code);"4"===b[0]?a.asInfo().withMessage("Failed api request").withStatusCode(b).log():a.asError().withMessage("Failed api request").withStatusCode(b).log()},data:d,headers:e,xhrFields:{withCredentials:!0}});var f={url:a,type:b,headers:e,data:d,timestamp:String((new Date).getTime())}}function l(b){return b.match(u)?b:"/api/v4"+b}var f=!1;this.poll=function(b,a,d){function k(){var h=e.getElapsedTime();d.headers=g.merge({"X-Extole-Polling-Time":h},d.headers);c(b,function(b,c){b||f||"FAILED"===
c.status?(f&&(b=Error("poll cancelled"),b.code="cancelled"),a(b||c.error)):"SUCCEEDED"===c.status?a(null,c):"PENDING"===c.status&&setTimeout(k,d.pollInterval||300)},d)}f=!1;a=a||function(){};d=d||{};var e=(new r).start();k()};this.cancel=function(){f=!0};this.get=c;this.post=function(b,a,d,c){e("post",b,a,d,c)};this.put=function(b,a,c,f){e("put",b,a,c,f)};this.delete=this.del=h}});